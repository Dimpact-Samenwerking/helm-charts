{{- if .Values.keycloak.enabled }}
# Database credentials secret for Keycloak Operator
# Note: Uses .Values.keycloak.externalDatabase.user (not .username) to maintain
# compatibility with the legacy Bitnami Keycloak chart structure
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.keycloak.secretsName }}
  labels:
    {{- include "podiumd.labels" . | nindent 4 }}
    app.kubernetes.io/component: keycloak
type: Opaque
stringData:
  database_username: {{ .Values.keycloak.externalDatabase.user | quote }}
  database_password: {{ .Values.keycloak.externalDatabase.password | quote }}
{{- end }}
---
{{- if or (index .Values "keycloak-operator").enabled .Values.keycloak.enabled }}
# Initial admin credentials for Keycloak Operator bootstrap.
# The operator reads this secret on first boot to set the admin account.
# Secret name must match: <cr-name>-initial-admin
apiVersion: v1
kind: Secret
metadata:
  name: {{ printf "%s-initial-admin" (default "keycloak" .Values.keycloak.name) }}
  labels:
    {{- include "podiumd.labels" . | nindent 4 }}
    app.kubernetes.io/component: keycloak
type: Opaque
stringData:
  username: {{ .Values.keycloak.auth.adminUser | quote }}
  password: {{ .Values.keycloak.auth.adminPassword | quote }}
{{- end }}
